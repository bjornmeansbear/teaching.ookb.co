<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="robots" content="noindex">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://unpkg.com/tachyons@4.6.1/css/tachyons.min.css"/>
  <link rel="stylesheet" href="customPlayer.css" />
</head>

<body class="pa4 tc">

  <div class="pa4">
      <button class="track1 trackButton bg-blue white pa2 f3 bn-ns " onclick="soloT1()" type="button">Master</button>
      <button class="track2 trackButton bg-gray white pa2 f3 bn-ns " onclick="soloT2()" type="button">Mix</button>
      <button class="track3 trackButton bg-gray white pa2 f3 bn-ns " onclick="soloT3()" type="button">Demo</button>
  </div>

  <audio id="multiTracks1" class="multiTrack" mediagroup="soundGroup" >
    <source src="audio/ds-3.mp3" type="audio/mpeg" />
    Your browser does not support HTML5 Audio.
  </audio>

  <audio id="multiTracks2" class="multiTrack" mediagroup="soundGroup" >
    <source src="audio/ds-2.mp3" type="audio/mpeg" />
    Your browser does not support HTML5 Audio.
  </audio>

  <audio id="multiTracks3" class="multiTrack" mediagroup="soundGroup" >
    <source src="audio/ds-1.mp3" type="audio/mpeg" />
    Your browser does not support HTML5 Audio.
  </audio>

  <div class="controls">
    <div>This will be a time slider...</div>
    <div class="timeControl mt2 mb4">
      <span class="timePlayed">00:00</span> <input type="range" min="0" max="1" step="0.01" value="0" id="songTime" oninput="timeUpdate(value)"> <span class="customDuration">{LoadBasedOnSong}</span>
    </div>
    <div class="buttonGroup">
      <button onclick="playAud()" type="button" class="toggle play bg-green white pa2 f3 bn-ns "><i class="fa fa-play" aria-hidden="true"></i></button>
      <button onclick="pauseAud()" class="toggle pause bg-yellow white pa2 f3 bn-ns " style="display:none;"><i class="fa fa-pause" aria-hidden="true"></i></button>
      <button onclick="resetAud()" class="stop bg-red white pa2 f3 bn-ns "><i class="fa fa-stop" aria-hidden="true"></i></button>
    </div>
    <div class="volumeControl mt2">
      <!-- http://brennaobrien.com/blog/2014/05/style-input-type-range-in-every-browser.html -->
      <input type="range" min="0" max="1" step="0.01" value="0.75" id="volume" oninput="volumeUpdate(value)"><i class="fa fa-volume-up" aria-hidden="true"></i>

    </div>
  </div>

  <script src="jquery-3.1.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.3.0/mustache.min.js"></script>

  <script>
      $('.toggle').click(function() {
        $('.play').toggle();
        $('.pause').toggle();
      })
      $('.stop').click(function() {
        $('.play').show();
        $('.pause').hide();
      })

      var snd1  = document.getElementById("multiTracks1");
      var snd2  = document.getElementById("multiTracks2");
      var snd3  = document.getElementById("multiTracks3");

      snd1.volume = .75;
      snd2.volume = .75;
      snd3.volume = .75;

      snd1.muted = false;
      snd2.muted = true;
      snd3.muted = true;

      function playAud() {
          snd1.play(); snd2.play(); snd3.play(); // Now all three will play at the same time
      }

      function pauseAud() {
          snd1.pause(); snd2.pause(); snd3.pause(); // Now all three will pause at the same time
      }

      function resetAud() {
          snd1.pause(); snd2.pause(); snd3.pause(); // Now all three will pause at the same time
          snd1.currentTime = 0;
          snd2.currentTime = 0;
          snd3.currentTime = 0; // Now all three will also go back to zero at the same time
      }
      // make individual track buttons do things
      $('.trackButton').click(function() {
          $('.trackButton').removeClass('bg-blue').addClass('bg-gray');
          $(this).addClass('bg-blue');
      });

      function soloT1() {
        snd1.muted = false;
        snd2.muted = true;
        snd3.muted = true;
      }
      function soloT2() {
        snd1.muted = true;
        snd2.muted = false;
        snd3.muted = true;
      }
      function soloT3() {
        snd1.muted = true;
        snd2.muted = true;
        snd3.muted = false;
      }

      // Master Volume!!!
      function volumeUpdate(vol) {
      	document.querySelector('#volume').value = vol;
        snd1.volume = vol;
        snd2.volume = vol;
        snd3.volume = vol;
      }

      // Time controls related
      leadingZero = function(number) {
        if (number < 10) {
            return ("0"+number);
        } else {
          return (number);
        }
      }

      var songLength = snd1.duration;
      var songMin = Math.floor(songLength / 60);
      var songSec = Math.round(songLength - (songMin * 60));
      var customMin = leadingZero(songMin);
      var customSec = leadingZero(songSec);
      var customDuration = customMin + ":" + customSec;
      $(".customDuration").html(customDuration);

      function timeUpdate(thisTime) {
        document.querySelector('#songTime').value = thisTime;
        var songLength = snd1.duration;
        var setNewTime = thisTime * songLength;

        snd1.currentTime = setNewTime;
        snd2.currentTime = setNewTime;
        snd3.currentTime = setNewTime;

        var songMin = Math.floor(setNewTime / 60);
        var songSec = Math.round(setNewTime - (songMin * 60));
        var customMin = leadingZero(songMin);
        var customSec = leadingZero(songSec);
        var customDuration = customMin + ":" + customSec;
        $(".timePlayed").html(customDuration);
      }

      // update time slider while tracks playing??????

  </script>
</body>

</html>
